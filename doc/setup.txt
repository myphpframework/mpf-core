

### Forbidden directories.
All the following directories: templates, classes, templates, i18n, config and include;
Should NOT be accessible from the web. A simple Apache2 Config can be added to the site as follow
<DirectoryMatch "templates|classes|i18n|config|include">
    deny from all
</DirectoryMatch>

It will recursively, for all sub directories, deny access to those folders. If you do not have access
to your site's Apache Config you can put a .htaccess at the root of your site and add the following lines:
############## Havent found the directives for doing it recursively (sub dirs) in htaccess. Rewrite_Mod.. not really waht I want bu last resort?

Alternatively you may have to add a .htaccess with the line "deny from all" in all subfolders that have those names. That is the last resort.


$_PUT  = array();
if($_SERVER['REQUEST_METHOD'] == 'PUT') {
    $putdata = file_get_contents('php://input');
    $exploded = explode('&', $putdata);
    foreach($exploded as $pair) {
        $item = explode('=', $pair);
        if(count($item) == 2) {
            $_PUT[urldecode($item[0])] = urldecode($item[1]);
        }
    }
}


########################## TRIGGER FOR HISTORY TABLE
DROP TRIGGER IF EXISTS history_trigger $$
 
CREATE TRIGGER history_trigger
BEFORE UPDATE ON clients
    FOR EACH ROW
    BEGIN
        IF OLD.first_name != NEW.first_name
        THEN
                INSERT INTO history_clients
                    (
                        client_id    ,
                        col          ,
                        value        ,
                        user_id      ,
                        edit_time
                    )
                    VALUES
                    (
                        NEW.client_id,
                        'first_name',
                        NEW.first_name,
                        NEW.editor_id,
                        NEW.last_mod
                    );
        END IF;
 
        IF OLD.last_name != NEW.last_name
        THEN
                INSERT INTO history_clients
                    (
                        client_id    ,
                        col          ,
                        value        ,
                        user_id      ,
                        edit_time
                    )
                    VALUES
                    (
                        NEW.client_id,
                        'last_name',
                        NEW.last_name,
                        NEW.editor_id,
                        NEW.last_mod
                    );
        END IF;
 
    END;
$$